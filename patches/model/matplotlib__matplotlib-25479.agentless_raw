```python
### lib/matplotlib/cm.py
<<<<<<< SEARCH
    if name is None:
        try:
            name = cmap.name
        except AttributeError as err:
            raise ValueError("Arguments must include a name or a "
                             "Colormap") from err
    # override_builtin is allowed here for backward compatibility
    # this is just a shim to enable that to work privately in
    # the global ColormapRegistry
    _colormaps._allow_override_builtin = override_builtin
    _colormaps.register(cmap, name=name, force=override_builtin)
    _colormaps._allow_override_builtin = False
=======
    if name is None:
        try:
            name = cmap.name
        except AttributeError as err:
            raise ValueError("Arguments must include a name or a "
                             "Colormap") from err
    # Ensure the colormap is registered with the provided name
    _colormaps._allow_override_builtin = override_builtin
    _colormaps.register(cmap, name=name, force=override_builtin)
    cmap.name = name  # Set the colormap's name to the registered name
    _colormaps._allow_override_builtin = False
>>>>>>> REPLACE
```