```python
### django/db/models/lookups.py
<<<<<<< SEARCH
    def get_prep_lookup(self):
        if hasattr(self.rhs, 'resolve_expression'):
            return self.rhs
        if self.prepare_rhs and hasattr(self.lhs.output_field, 'get_prep_value'):
            return self.lhs.output_field.get_prep_value(self.rhs)
        return self.rhs
=======
    def get_prep_lookup(self):
        if hasattr(self.rhs, 'resolve_expression'):
            return self.rhs
        if self.prepare_rhs and hasattr(self.lhs.output_field, 'get_prep_value'):
            if isinstance(self.rhs, SimpleLazyObject):
                return self.lhs.output_field.get_prep_value(self.rhs())
            return self.lhs.output_field.get_prep_value(self.rhs)
        return self.rhs
>>>>>>> REPLACE
```