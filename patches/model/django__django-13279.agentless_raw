```python
### django/contrib/sessions/backends/base.py
<<<<<<< SEARCH
    def encode(self, session_dict):
        "Return the given session dictionary serialized and encoded as a string."
        return signing.dumps(
            session_dict, salt=self.key_salt, serializer=self.serializer,
            compress=True,
        )
=======
    def encode(self, session_dict):
        "Return the given session dictionary serialized and encoded as a string."
        if settings.DEFAULT_HASHING_ALGORITHM == 'sha1':
            return signing.dumps(
                session_dict, salt=self.key_salt, serializer=self.serializer,
                compress=True, algorithm='sha1',
            )
        return signing.dumps(
            session_dict, salt=self.key_salt, serializer=self.serializer,
            compress=True,
        )
>>>>>>> REPLACE
```

```python
### django/core/signing.py
<<<<<<< SEARCH
    def _legacy_signature(self, value):
        # RemovedInDjango40Warning.
        return base64_hmac(self.salt + 'signer', value, self.key, algorithm=self.legacy_algorithm)
=======
    def _legacy_signature(self, value):
        # RemovedInDjango40Warning.
        if settings.DEFAULT_HASHING_ALGORITHM == 'sha1':
            return base64_hmac(self.salt + 'signer', value, self.key, algorithm=self.legacy_algorithm)
        return base64_hmac(self.salt + 'signer', value, self.key, algorithm=self.algorithm)
>>>>>>> REPLACE
```

These changes ensure that the session data can be encoded and decoded correctly during the transition to Django 3.1, especially when `DEFAULT_HASHING_ALGORITHM` is set to 'sha1'. This approach uses the legacy encoding and decoding methods when necessary to maintain compatibility.