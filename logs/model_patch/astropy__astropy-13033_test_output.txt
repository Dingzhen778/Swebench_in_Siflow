>>>>> Start Test Output
+ export PYTHONPATH=/testbed:
+ PYTHONPATH=/testbed:
+ echo PYTHONPATH=/testbed:
PYTHONPATH=/testbed:
+ pytest -rA astropy/timeseries/tests/test_sampled.py
<frozen importlib._bootstrap>:228: RuntimeWarning: numpy.ndarray size changed, may indicate binary incompatibility. Expected 80 from C header, got 96 from PyObject
============================= test session starts ==============================
platform linux -- Python 3.9.25, pytest-7.4.0, pluggy-1.3.0

Running tests with Astropy version 5.1.dev762+g5ddcd5c81.d20251211.
Running tests in astropy/timeseries/tests/test_sampled.py.

Date: 2025-12-11T15:22:21

Platform: Linux-5.15.0-94-generic-x86_64-with-glibc2.35

Executable: /opt/miniconda3/envs/testbed/bin/python

Full Python Version: 
3.9.25 (main, Nov  3 2025, 22:33:05) 
[GCC 11.2.0]

encodings: sys: utf-8, locale: UTF-8, filesystem: utf-8
byteorder: little
float info: dig: 15, mant_dig: 15

Package versions: 
Numpy: 1.25.2
Scipy: not available
Matplotlib: not available
h5py: not available
Pandas: not available
PyERFA: 2.0.0.3
Cython: not available
Scikit-image: not available
asdf: not available
pyarrow: not available

Using Astropy options: remote_data: none.

ARCH_ON_CI: undefined
IS_CRON: undefined

rootdir: /testbed
configfile: setup.cfg
plugins: remotedata-0.4.0, doctestplus-1.0.0, filter-subpackage-0.1.2, astropy-0.10.0, hypothesis-6.82.6, mock-3.11.1, xdist-3.3.1, arraydiff-0.5.0, openfiles-0.5.0, astropy-header-0.2.2, cov-4.1.0
collected 25 items

astropy/timeseries/tests/test_sampled.py .F....F.........s...ssF..       [100%]

=================================== FAILURES ===================================
______________________ test_empty_initialization_invalid _______________________

    def test_empty_initialization_invalid():
        # Make sure things crash when the first column added is not a time column
        ts = TimeSeries()
        with pytest.raises(ValueError) as exc:
            ts['flux'] = [1, 2, 3]
>       assert exc.value.args[0] == ("TimeSeries object is invalid - expected "
                                     "'time' as the first column but found 'flux'")
E       assert "TimeSeries o...time' missing" == "TimeSeries o... found 'flux'"
E         - TimeSeries object is invalid - expected 'time' as the first column but found 'flux'
E         + TimeSeries object is invalid - required column 'time' missing

astropy/timeseries/tests/test_sampled.py:37: AssertionError
_____________________ test_initialization_with_time_delta ______________________

files = None

    def update_leap_seconds(files=None):
        """If the current ERFA leap second table is out of date, try to update it.
    
        Uses `astropy.utils.iers.LeapSeconds.auto_open` to try to find an
        up-to-date table.  See that routine for the definition of "out of date".
    
        In order to make it safe to call this any time, all exceptions are turned
        into warnings,
    
        Parameters
        ----------
        files : list of path-like, optional
            List of files/URLs to attempt to open.  By default, uses defined by
            `astropy.utils.iers.LeapSeconds.auto_open`, which includes the table
            used by ERFA itself, so if that is up to date, nothing will happen.
    
        Returns
        -------
        n_update : int
            Number of items updated.
    
        """
        try:
            from astropy.utils import iers
    
>           table = iers.LeapSeconds.auto_open(files)

astropy/time/core.py:2824: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

cls = <class 'astropy.utils.iers.iers.LeapSeconds'>
files = ['erfa', '/testbed/astropy/utils/iers/data/Leap_Second.dat', 'https://hpiers.obspm.fr/iers/bul/bulc/Leap_Second.dat', 'https://www.ietf.org/timezones/data/leap-seconds.list']

    @classmethod
    def auto_open(cls, files=None):
        """Attempt to get an up-to-date leap-second list.
    
        The routine will try the files in sequence until it finds one
        whose expiration date is "good enough" (see below).  If none
        are good enough, it returns the one with the most recent expiration
        date, warning if that file is expired.
    
        For remote files that are cached already, the cached file is tried
        first before attempting to retrieve it again.
    
        Parameters
        ----------
        files : list of path-like, optional
            List of files/URLs to attempt to open.  By default, uses
            ``cls._auto_open_files``.
    
        Returns
        -------
        leap_seconds : `~astropy.utils.iers.LeapSeconds`
            Up to date leap-second table
    
        Notes
        -----
        Bulletin C is released about 10 days after a possible leap second is
        introduced, i.e., mid-January or mid-July.  Expiration days are thus
        generally at least 150 days after the present.  We look for a file
        that expires more than 180 - `~astropy.utils.iers.Conf.auto_max_age`
        after the present.
        """
        offset = 180 - (30 if conf.auto_max_age is None else conf.auto_max_age)
        good_enough = cls._today() + TimeDelta(offset, format='jd')
    
        if files is None:
            # Basic files to go over (entries in _auto_open_files can be
            # configuration items, which we want to be sure are up to date).
            files = [getattr(conf, f, f) for f in cls._auto_open_files]
    
        # Remove empty entries.
        files = [f for f in files if f]
    
        # Our trials start with normal files and remote ones that are
        # already in cache.  The bools here indicate that the cache
        # should be used.
        trials = [(f, True) for f in files
                  if not urlparse(f).netloc or is_url_in_cache(f)]
        # If we are allowed to download, we try downloading new versions
        # if none of the above worked.
        if conf.auto_download:
            trials += [(f, False) for f in files if urlparse(f).netloc]
    
        self = None
        err_list = []
        # Go through all entries, and return the first one that
        # is not expired, or the most up to date one.
        for f, allow_cache in trials:
            if not allow_cache:
                clear_download_cache(f)
    
            try:
                trial = cls.open(f, cache=True)
            except Exception as exc:
                err_list.append(exc)
                continue
    
            if self is None or trial.expires > self.expires:
                self = trial
                self.meta['data_url'] = str(f)
                if self.expires > good_enough:
                    break
    
        if self is None:
            raise ValueError('none of the files could be read. The '
                             'following errors were raised:\n' + str(err_list))
    
        if self.expires < self._today() and conf.auto_max_age is not None:
>           warn('leap-second file is expired.', IERSStaleWarning)
E           astropy.utils.iers.iers.IERSStaleWarning: leap-second file is expired.

astropy/utils/iers/iers.py:1032: IERSStaleWarning

During handling of the above exception, another exception occurred:

    def test_initialization_with_time_delta():
>       ts = TimeSeries(time_start=datetime(2018, 7, 1, 10, 10, 10),
                        time_delta=TimeDelta(3, format='sec'),
                        data=[[10, 2, 3], [4, 5, 6]], names=['a', 'b'])

astropy/timeseries/tests/test_sampled.py:67: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
astropy/timeseries/sampled.py:122: in __init__
    time = time_start + time_delta
astropy/time/core.py:2208: in __add__
    out._set_scale('tai')
astropy/time/core.py:554: in _set_scale
    _check_leapsec()
astropy/time/core.py:2795: in _check_leapsec
    update_leap_seconds()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

files = None

    def update_leap_seconds(files=None):
        """If the current ERFA leap second table is out of date, try to update it.
    
        Uses `astropy.utils.iers.LeapSeconds.auto_open` to try to find an
        up-to-date table.  See that routine for the definition of "out of date".
    
        In order to make it safe to call this any time, all exceptions are turned
        into warnings,
    
        Parameters
        ----------
        files : list of path-like, optional
            List of files/URLs to attempt to open.  By default, uses defined by
            `astropy.utils.iers.LeapSeconds.auto_open`, which includes the table
            used by ERFA itself, so if that is up to date, nothing will happen.
    
        Returns
        -------
        n_update : int
            Number of items updated.
    
        """
        try:
            from astropy.utils import iers
    
            table = iers.LeapSeconds.auto_open(files)
            return erfa.leap_seconds.update(table)
    
        except Exception as exc:
>           warn("leap-second auto-update failed due to the following "
                 f"exception: {exc!r}", AstropyWarning)
E           astropy.utils.exceptions.AstropyWarning: leap-second auto-update failed due to the following exception: IERSStaleWarning('leap-second file is expired.')

astropy/time/core.py:2828: AstropyWarning
____________________________ test_required_columns _____________________________

    def test_required_columns():
    
        # Test the machinery that makes sure that the required columns are present
    
        ts = TimeSeries(time=INPUT_TIME,
                        data=[[10, 2, 3], [4, 5, 6]],
                        names=['a', 'b'])
    
        # In the examples below, the operation (e.g. remove_column) is actually
        # carried out before the checks are made, so we need to use copy() so that
        # we don't change the main version of the time series.
    
        # Make sure copy works fine
        ts.copy()
    
        with pytest.raises(ValueError) as exc:
            ts.copy().add_column(Column([3, 4, 5], name='c'), index=0)
        assert exc.value.args[0] == ("TimeSeries object is invalid - expected "
                                     "'time' as the first column but found 'c'")
    
        with pytest.raises(ValueError) as exc:
            ts.copy().add_columns([Column([3, 4, 5], name='d'),
                                   Column([3, 4, 5], name='e')], indexes=[0, 1])
        assert exc.value.args[0] == ("TimeSeries object is invalid - expected "
                                     "'time' as the first column but found 'd'")
    
        with pytest.raises(ValueError) as exc:
            ts.copy().keep_columns(['a', 'b'])
>       assert exc.value.args[0] == ("TimeSeries object is invalid - expected "
                                     "'time' as the first column but found 'a'")
E       assert "TimeSeries o...time' missing" == "TimeSeries o...but found 'a'"
E         - TimeSeries object is invalid - expected 'time' as the first column but found 'a'
E         + TimeSeries object is invalid - required column 'time' missing

astropy/timeseries/tests/test_sampled.py:380: AssertionError
==================================== PASSES ====================================
=========================== short test summary info ============================
PASSED astropy/timeseries/tests/test_sampled.py::test_empty_initialization
PASSED astropy/timeseries/tests/test_sampled.py::test_initialize_only_time
PASSED astropy/timeseries/tests/test_sampled.py::test_initialization_with_data
PASSED astropy/timeseries/tests/test_sampled.py::test_initialize_only_data
PASSED astropy/timeseries/tests/test_sampled.py::test_initialization_with_table
PASSED astropy/timeseries/tests/test_sampled.py::test_initialization_missing_time_delta
PASSED astropy/timeseries/tests/test_sampled.py::test_initialization_invalid_time_and_time_start
PASSED astropy/timeseries/tests/test_sampled.py::test_initialization_invalid_time_delta
PASSED astropy/timeseries/tests/test_sampled.py::test_initialization_with_time_in_data
PASSED astropy/timeseries/tests/test_sampled.py::test_initialization_n_samples
PASSED astropy/timeseries/tests/test_sampled.py::test_initialization_length_mismatch
PASSED astropy/timeseries/tests/test_sampled.py::test_initialization_invalid_both_time_and_time_delta
PASSED astropy/timeseries/tests/test_sampled.py::test_fold
PASSED astropy/timeseries/tests/test_sampled.py::test_fold_invalid_options
PASSED astropy/timeseries/tests/test_sampled.py::test_read_time_missing
PASSED astropy/timeseries/tests/test_sampled.py::test_read_time_wrong
PASSED astropy/timeseries/tests/test_sampled.py::test_read
PASSED astropy/timeseries/tests/test_sampled.py::test_periodogram[BoxLeastSquares]
PASSED astropy/timeseries/tests/test_sampled.py::test_periodogram[LombScargle]
SKIPPED [1] astropy/timeseries/tests/test_sampled.py:272: could not import 'pandas': No module named 'pandas'
SKIPPED [2] ../opt/miniconda3/envs/testbed/lib/python3.9/site-packages/pytest_remotedata/plugin.py:85: need --remote-data option to run
FAILED astropy/timeseries/tests/test_sampled.py::test_empty_initialization_invalid
FAILED astropy/timeseries/tests/test_sampled.py::test_initialization_with_time_delta
FAILED astropy/timeseries/tests/test_sampled.py::test_required_columns - asse...
=================== 3 failed, 19 passed, 3 skipped in 0.23s ====================
>>>>> End Test Output
SWEBENCH_TEST_EXIT_CODE=1
